/*!CK:450064779!*//*1456348051,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["b470V"]); }

__d('BehaviorsMixin',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(l){'use strict';this.$InstalledBehavior1=l;this.$InstalledBehavior2=false;}h.prototype.enable=function(){'use strict';if(!this.$InstalledBehavior2){this.$InstalledBehavior2=true;this.$InstalledBehavior1.enable();}};h.prototype.disable=function(){'use strict';if(this.$InstalledBehavior2){this.$InstalledBehavior2=false;this.$InstalledBehavior1.disable();}};var i=1;function j(l){if(!l.__BEHAVIOR_ID)l.__BEHAVIOR_ID=i++;return l.__BEHAVIOR_ID;}var k={enableBehavior:function(l){if(!this._behaviors)this._behaviors={};var m=j(l);if(!this._behaviors[m])this._behaviors[m]=new h(new l(this));this._behaviors[m].enable();return this;},disableBehavior:function(l){if(this._behaviors){var m=j(l);if(this._behaviors[m])this._behaviors[m].disable();}return this;},enableBehaviors:function(l){l.forEach(this.enableBehavior,this);return this;},destroyBehaviors:function(){if(this._behaviors){for(var l in this._behaviors)this._behaviors[l].disable();this._behaviors={};}},hasBehavior:function(l){return this._behaviors&&j(l) in this._behaviors;}};f.exports=k;},null);
__d('getOpacityStyleName',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=false,i=null;function j(){if(!h){if('opacity' in document.body.style){i='opacity';}else{var k=document.createElement('div');k.style.filter='alpha(opacity=100)';if(k.style.filter)i='filter';k=null;}h=true;}return i;}f.exports=j;},null);
__d('getStyleProperty',['camelize','hyphenate'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(l){return l==null?l:String(l);}function k(l,m){var n=undefined;if(window.getComputedStyle){n=window.getComputedStyle(l,null);if(n)return j(n.getPropertyValue(i(m)));}if(document.defaultView&&document.defaultView.getComputedStyle){n=document.defaultView.getComputedStyle(l,null);if(n)return j(n.getPropertyValue(i(m)));if(m==='display')return 'none';}if(l.currentStyle){if(m==='float')return j(l.currentStyle.cssFloat||l.currentStyle.styleFloat);return j(l.currentStyle[h(m)]);}return j(l.style&&l.style[h(m)]);}f.exports=k;},null);
__d('Style-upstream',['camelize','containsNode','ex','getOpacityStyleName','getStyleProperty','hyphenate','invariant'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();function o(v,w){var x=u.get(v,w);return x==='auto'||x==='scroll';}var p=new RegExp('\\s*'+'([^\\s:]+)'+'\\s*:\\s*'+'([^;(\'"]*(?:(?:\\([^)]*\\)|"[^"]*"|\'[^\']*\')[^;(?:\'"]*)*)'+'(?:;|$)','g');function q(v){var w={};v.replace(p,function(x,y,z){w[y]=z;});return w;}function r(v){var w='';for(var x in v)if(v[x])w+=x+':'+v[x]+';';return w;}function s(v){return v!==''?'alpha(opacity='+v*100+')':'';}function t(v,w,x){switch(m(w)){case 'font-weight':case 'line-height':case 'opacity':case 'z-index':break;case 'width':case 'height':var y=parseInt(x,10)<0;!!y?n(0):undefined;default:!(isNaN(x)||!x||x==='0')?n(0):undefined;break;}}var u={set:function(v,w,x){t('Style.set',w,x);var y=v.style;switch(w){case 'opacity':if(k()==='filter'){y.filter=s(x);}else y.opacity=x;break;case 'float':y.cssFloat=y.styleFloat=x||'';break;default:try{y[h(w)]=x;}catch(z){throw new Error(j('Style.set: "%s" argument is invalid: %s',w,x));}}},apply:function(v,w){var x=undefined;for(x in w)t('Style.apply',x,w[x]);if('opacity' in w&&k()==='filter'){w.filter=s(w.opacity);delete w.opacity;}var y=q(v.style.cssText);for(x in w){var z=w[x];delete w[x];var aa=m(x);for(var ba in y)if(ba===aa||ba.indexOf(aa+'-')===0)delete y[ba];w[aa]=z;}Object.assign(y,w);v.style.cssText=r(y);},get:l,getFloat:function(v,w){return parseFloat(u.get(v,w),10);},getOpacity:function(v){if(k()==='filter'){var w=u.get(v,'filter');if(w){var x=/(\d+(?:\.\d+)?)/.exec(w);if(x)return parseFloat(x.pop())/100;}}return u.getFloat(v,'opacity')||1;},isFixed:function(v){while(i(document.body,v)){if(u.get(v,'position')==='fixed')return true;v=v.parentNode;}return false;},getScrollParent:function(v){if(!v)return null;while(v&&v!==document.body){if(o(v,'overflow')||o(v,'overflowY')||o(v,'overflowX'))return v;v=v.parentNode;}return window;}};f.exports=u;},null);
__d('Style',['Style-upstream','$'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=babelHelpers['extends']({},h,{get:function(k,l){typeof k==='string';return h.get(i(k),l);},getFloat:function(k,l){typeof k==='string';return h.getFloat(i(k),l);}});f.exports=j;},null);
__d("areJSONRepresentationsEqual",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j){return JSON.stringify(i)==JSON.stringify(j);}f.exports=h;},null);
__d('getScrollPosition',['getDocumentScrollElement','getUnboundedScrollPosition'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();function j(k){var l=h();if(k===window)k=l;var m=i(k),n=k===l?document.documentElement:k,o=k.scrollWidth-n.clientWidth,p=k.scrollHeight-n.clientHeight;m.x=Math.max(0,Math.min(m.x,o));m.y=Math.max(0,Math.min(m.y,p));return m;}f.exports=j;},null);
__d('mixin',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j,k,l,m,n,o,p,q,r,s){var t=function(){},u=[i,j,k,l,m,n,o,p,q,r],v=0,w=undefined;while(u[v]){w=u[v];for(var x in w)if(w.hasOwnProperty(x))t.prototype[x]=w[x];v+=1;}return t;}f.exports=h;},null);
__d('errorCode',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){throw new Error('errorCode'+'("'+i+'"): This should not happen. Oh noes!');}f.exports=h;},null);
__d('ArbiterMixin',['Arbiter','guid'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j="arbiter$"+i(),k=Object.prototype.hasOwnProperty,l={_getArbiterInstance:function(){return k.call(this,j)?this[j]:this[j]=new h();},inform:function(m,n,o){return this._getArbiterInstance().inform(m,n,o);},subscribe:function(m,n,o){return this._getArbiterInstance().subscribe(m,n,o);},subscribeOnce:function(m,n,o){return this._getArbiterInstance().subscribeOnce(m,n,o);},unsubscribe:function(m){this._getArbiterInstance().unsubscribe(m);},unsubscribeCurrentSubscription:function(){this._getArbiterInstance().unsubscribeCurrentSubscription();},releaseCurrentPersistentEvent:function(){this._getArbiterInstance().releaseCurrentPersistentEvent();},registerCallback:function(m,n){return this._getArbiterInstance().registerCallback(m,n);},query:function(m){return this._getArbiterInstance().query(m);}};f.exports=l;},null);
__d('AsyncResponse',['Bootloader','DTSG','SiteData','errorCode'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();function l(m,n){'use strict';Object.assign(this,{error:0,errorSummary:null,errorDescription:null,onload:null,replay:false,payload:n||null,request:m||null,silentError:false,transientError:false,blockedAction:false,is_last:true});return this;}l.prototype.getRequest=function(){'use strict';return this.request;};l.prototype.getPayload=function(){'use strict';return this.payload;};l.prototype.getError=function(){'use strict';return this.error;};l.prototype.getErrorSummary=function(){'use strict';return this.errorSummary;};l.prototype.setErrorSummary=function(m){'use strict';m=m===undefined?null:m;this.errorSummary=m;return this;};l.prototype.getErrorDescription=function(){'use strict';return this.errorDescription;};l.prototype.getErrorIsWarning=function(){'use strict';return !!this.errorIsWarning;};l.prototype.isTransient=function(){'use strict';return !!this.transientError;};l.prototype.isBlockedAction=function(){'use strict';return !!this.blockedAction;};l.prototype.logError=function(m,n){'use strict';var o=b.ErrorSignal;if(o){var p={err_code:this.error,vip:j.vip||'-'};if(n){p.duration=n.duration;p.xfb_ip=n.xfb_ip;}var q=this.request.getURI();p.path=q||'-';p.aid=this.request.userActionID;if(q&&q.indexOf('scribe_endpoint.php')!=-1)m='async_error_double';o.sendErrorSignal(m,JSON.stringify(p));}};l.prototype.logErrorByGroup=function(m,n){'use strict';if(Math.floor(Math.random()*n)===0)if(this.error==1357010||this.error<15000){this.logError('async_error_oops_'+m);}else this.logError('async_error_logic_'+m);};l.defaultErrorHandler=function(m){'use strict';try{if(!m.silentError){l.verboseErrorHandler(m);}else m.logErrorByGroup('silent',10);}catch(n){alert(m);}};l.verboseErrorHandler=function(m){'use strict';h.loadModules(["ExceptionDialog"],function(n){return n.showAsyncError(m);});};l.renewDTSG=function(m){'use strict';i.setToken(m);};f.exports=l;},null);
__d('HTTPErrors',['emptyFunction'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={get:h,getAll:h};f.exports=i;},null);
__d('JSONPTransport',['ArbiterMixin','DOM','HTML','TimeSlice','URI','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m){var n,o;if(c.__markCompiled)c.__markCompiled();var p={},q=2,r='jsonp',s='iframe';function t(v){delete p[v];}n=babelHelpers.inherits(u,m(h));o=n&&n.prototype;function u(v,w){'use strict';o.constructor.call(this);this._type=v;this._uri=w;this._hasResponse=false;p[this.getID()]=this;}u.prototype.getID=function(){'use strict';return this._id||(this._id=q++);};u.prototype.hasFinished=function(){'use strict';return !(this.getID() in p);};u.prototype.getRequestURI=function(){'use strict';return new l(this._uri).addQueryData({__a:1,__adt:this.getID(),__req:'jsonp_'+this.getID()});};u.prototype.getTransportFrame=function(){'use strict';if(this._iframe)return this._iframe;var v='transport_frame_'+this.getID(),w=j('<iframe class="hidden_elem" name="'+v+'" src="javascript:void(0)" />');return this._iframe=i.appendContent(document.body,w)[0];};u.prototype.send=function(){'use strict';if(this._type===r){setTimeout(function(){i.appendContent(document.body,i.create('script',{src:this.getRequestURI().toString(),type:'text/javascript'}));}.bind(this),0);}else{this.getTransportFrame().onload=this._checkForErrors.bind(this);this.getTransportFrame().src=this.getRequestURI().toString();}};u.prototype.handleResponse=function(v){'use strict';this.inform('response',v);if(this.hasFinished())setTimeout(this._cleanup.bind(this),0);};u.prototype.abort=function(){'use strict';if(this._aborted)return;this._aborted=true;this._cleanup();t(this.getID());this.inform('abort');};u.prototype._checkForErrors=function(){'use strict';if(!this._hasResponse)this.abort();};u.prototype._cleanup=function(){'use strict';if(this._iframe){i.remove(this._iframe);this._iframe=null;}};u.respond=function(v,w,x){'use strict';var y=p[v];if(y){y._hasResponse=true;if(!x)t(v);if(y._type==s)if(typeof w==='string'){w=JSON.parse(w);}else w=JSON.parse(JSON.stringify(w));y.handleResponse(w);}else{var z=b.ErrorSignal;if(z&&!x)z.logJSError('ajax',{error:'UnexpectedJsonResponse',extra:{id:v,uri:w.payload&&w.payload.uri||''}});}};u.respond=k.guard(u.respond,'JSONPTransport.respond',{root:true});f.exports=u;},null);
__d('bind',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j){var k=Array.prototype.slice.call(arguments,2);if(typeof j!='string')return Function.prototype.bind.apply(j,[i].concat(k));function l(){var m=k.concat(Array.prototype.slice.call(arguments));if(i[j])return i[j].apply(i,m);}l.toString=function(){return 'bound lazily: '+i[j];};return l;}f.exports=h;},null);
__d("executeAfter",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j,k){return function l(){i.apply(k||this,arguments);j.apply(k||this,arguments);};}f.exports=h;},null);
__d('isMessengerDotComURI',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=new RegExp('(^|\\.)messenger\\.com$','i'),i=['https'];function j(k){if(k.isEmpty()&&k.toString()!=='#')return false;if(!k.getDomain()&&!k.getProtocol())return false;return (i.indexOf(k.getProtocol())!==-1&&h.test(k.getDomain()));}f.exports=j;},null);
__d('AsyncRequest',['Arbiter','AsyncRequestConfig','AsyncResponse','Bootloader','CSS','DTSG','Env','ErrorUtils','Event','HTTPErrors','JSCC','Parent','PHPQuerySerializer','Run','ServerJS','TimeSlice','URI','UserAgent_DEPRECATED','isFacebookURI','isMessengerDotComURI','bind','emptyFunction','errorCode','evalGlobal','executeAfter','ge','getAsyncHeaders','getAsyncParams','getSameOriginTransport','goURI','invariant','isEmpty','ix','setTimeout','setTimeoutAcrossTransitions','fbt'],function a(global,require,requireDynamic,requireLazy,module,exports,Arbiter,AsyncRequestConfig,AsyncResponse,Bootloader,CSS,DTSG,Env,ErrorUtils,Event,HTTPErrors,JSCC,Parent,PHPQuerySerializer,Run,ServerJS,TimeSlice,URI,UserAgent_DEPRECATED,isFacebookURI,isMessengerDotComURI,bind,emptyFunction,errorCode,evalGlobal,executeAfter,ge,getAsyncHeaders,getAsyncParams,getSameOriginTransport,goURI,invariant,isEmpty,ix,setTimeout,setTimeoutAcrossTransitions,fbt){if(require.__markCompiled)require.__markCompiled();function hasUnloaded(){try{return !window.domready;}catch(ignore){return true;}}function supportsUploadProgress(transport){return 'upload' in transport&&'onprogress' in transport.upload;}function supportsCrossOrigin(transport){return 'withCredentials' in transport;}function isNetworkError(transport){return transport.status in {0:1,12029:1,12030:1,12031:1,12152:1};}function validateResponseHandler(handler){var valid=!handler||typeof handler==='function';return valid;}var last_id=2,id_threshold=last_id;Arbiter.subscribe('page_transition',function(_,message){id_threshold=message.id;});function AsyncRequest(uri){'use strict';Object.assign(this,{transport:null,method:'POST',uri:'',timeout:null,timer:null,initialHandler:emptyFunction,handler:null,uploadProgressHandler:null,errorHandler:null,transportErrorHandler:null,timeoutHandler:null,interceptHandler:emptyFunction,finallyHandler:emptyFunction,abortHandler:emptyFunction,serverDialogCancelHandler:null,relativeTo:null,statusElement:null,statusClass:'',data:{},headers:{},file:null,context:{},readOnly:false,writeRequiredParams:[],remainingRetries:0,userActionID:'-'});this.option={asynchronous_DEPRECATED:true,suppressErrorHandlerWarning:false,suppressEvaluation:false,suppressErrorAlerts:false,retries:0,jsonp:false,bundle:false,useIframeTransport:false,handleErrorAfterUnload:false};this.errorHandler=AsyncResponse.defaultErrorHandler;this.transportErrorHandler=bind(this,'errorHandler');if(uri!==undefined)this.setURI(uri);this.setAllowCrossPageTransition(AsyncRequestConfig.asyncRequestsSurviveTransitionsDefault||false);}AsyncRequest.prototype._dispatchResponse=function(asyncResponse){'use strict';this.clearStatusIndicator();if(!this._isRelevant()){this._invokeErrorHandler(1010);return;}if(this.initialHandler(asyncResponse)===false)return;clearTimeout(this.timer);if(asyncResponse.jscc_map){var jscc_map=eval(asyncResponse.jscc_map);JSCC.init(jscc_map);}var suppress_js;if(this.handler)try{suppress_js=this._shouldSuppressJS(this.handler(asyncResponse));}catch(e){asyncResponse.is_last&&this.finallyHandler(asyncResponse);throw e;}if(!suppress_js)this._handleJSResponse(asyncResponse);asyncResponse.is_last&&this.finallyHandler(asyncResponse);};AsyncRequest.prototype._shouldSuppressJS=function(handler_return_value){'use strict';return handler_return_value===AsyncRequest.suppressOnloadToken;};AsyncRequest.prototype._handleJSResponse=function(asyncResponse){'use strict';var relativeTo=this.getRelativeTo(),domOps=asyncResponse.domops,dtsgToken=asyncResponse.dtsgToken,jsMods=asyncResponse.jsmods,serverJS=new ServerJS().setRelativeTo(relativeTo),requires;if(jsMods&&jsMods.require){requires=jsMods.require;delete jsMods.require;}if(jsMods)serverJS.handle(jsMods);if(dtsgToken)DTSG.setToken(dtsgToken);var finishHandleResp=function(AsyncDOM){if(domOps&&AsyncDOM)AsyncDOM.invoke(domOps,relativeTo);if(requires)serverJS.handle({require:requires});this._handleJSRegisters(asyncResponse,'onload');if(this.lid)Arbiter.inform('tti_ajax',{s:this.lid,d:[this._sendTimeStamp||0,this._sendTimeStamp&&this._responseTime?this._responseTime-this._sendTimeStamp:0]},Arbiter.BEHAVIOR_EVENT);this._handleJSRegisters(asyncResponse,'onafterload');serverJS.cleanup();}.bind(this);if(domOps){Bootloader.loadModules(["AsyncDOM"],finishHandleResp);}else finishHandleResp(null);};AsyncRequest.prototype._handleJSRegisters=function(asyncResponse,phase){'use strict';var registers=asyncResponse[phase];if(registers)for(var ii=0;ii<registers.length;ii++)ErrorUtils.applyWithGuard(new Function(registers[ii]),this);};AsyncRequest.prototype.invokeResponseHandler=function(interpreted){'use strict';if(typeof interpreted.redirect!=='undefined'){setTimeout(function(){this.setURI(interpreted.redirect).send();}.bind(this),0);return;}if(!this.handler&&!this.errorHandler&&!this.transportErrorHandler)return;var response=interpreted.asyncResponse;if(typeof response!=='undefined'){if(!this._isRelevant()){this._invokeErrorHandler(1010);return;}if(response.inlinejs)evalGlobal(response.inlinejs);if(response.lid){this._responseTime=Date.now();if(global.CavalryLogger)this.cavalry=global.CavalryLogger.getInstance(response.lid);this.lid=response.lid;}if(response.resource_map)Bootloader.setResourceMap(response.resource_map);if(response.bootloadable)Bootloader.enableBootload(response.bootloadable);ix.add(response.ixData);var dispatch,arbiter_event;if(response.getError()&&!response.getErrorIsWarning()){var handler=this.errorHandler.bind(this);dispatch=ErrorUtils.guard(this._dispatchErrorResponse,'AsyncRequest#_dispatchErrorResponse for '+this.getURI());dispatch=dispatch.bind(this,response,handler);arbiter_event='error';}else{dispatch=ErrorUtils.guard(this._dispatchResponse,'AsyncRequest#_dispatchResponse for '+this.getURI());dispatch=dispatch.bind(this,response);arbiter_event='response';}dispatch=executeAfter(dispatch,function(){Arbiter.inform('AsyncRequest/'+arbiter_event,{request:this,response:response});}.bind(this));var replace=false;if(this.preBootloadHandler)replace=this.preBootloadHandler(response);response.css=response.css||[];response.js=response.js||[];Bootloader.loadResources(response.css.concat(response.js),function(){setTimeout(dispatch,0);},replace,this.getURI());}else if(typeof interpreted.transportError!=='undefined'){if(this._xFbServer){this._invokeErrorHandler(1008);}else this._invokeErrorHandler(1012);}else this._invokeErrorHandler(1007);};AsyncRequest.prototype._invokeErrorHandler=function(explicitError){'use strict';var error;if(this.responseText===''){error=1002;}else if(this._requestAborted){error=1011;}else{try{error=explicitError||this.transport.status||1004;}catch(e2){error=1005;}if(false===navigator.onLine)error=1006;}var desc,summary,silent=true;if(error===1006){summary=fbt._("No Network Connection");desc=fbt._("Your browser appears to be offline. Please check your internet connection and try again.");}else if(error>=300&&error<=399){summary=fbt._("Redirection");desc=fbt._("Your access to Facebook was redirected or blocked by a third party at this time, please contact your ISP or reload.");var location=this.transport.getResponseHeader("Location");if(location)goURI(location,true);silent=true;}else{summary=fbt._("Oops");desc=fbt._("Something went wrong. We're working on getting this fixed as soon as we can. You may be able to try again.");}var async_response=new AsyncResponse(this);Object.assign(async_response,{error:error,errorSummary:summary,errorDescription:desc,silentError:silent});setTimeout(function(){Arbiter.inform('AsyncRequest/error',{request:this,response:async_response});}.bind(this),0);if(hasUnloaded()&&!this.getOption('handleErrorAfterUnload'))return;if(!this.transportErrorHandler)return;var error_handler=this.transportErrorHandler.bind(this);!this.getOption('suppressErrorAlerts');ErrorUtils.applyWithGuard(this._dispatchErrorResponse,this,[async_response,error_handler]);};AsyncRequest.prototype._dispatchErrorResponse=function(asyncResponse,errorHandler){'use strict';var error=asyncResponse.getError();this.clearStatusIndicator();var log_data=this._sendTimeStamp&&{duration:Date.now()-this._sendTimeStamp,xfb_ip:this._xFbServer||'-'};asyncResponse.logError('async_error',log_data);if(!this._isRelevant()||error===1010){this.abort();return;}if(error==1357008||error==1357007||error==1357041||error==1442002||error==1357001){var is_confirmation=error==1357008||error==1357007;this.interceptHandler(asyncResponse);if(error==1357041){this._solveQuicksandChallenge(asyncResponse);}else this._displayServerDialog(asyncResponse,is_confirmation);}else if(this.initialHandler(asyncResponse)!==false){clearTimeout(this.timer);try{errorHandler(asyncResponse);}catch(e){this.finallyHandler(asyncResponse);throw e;}this.finallyHandler(asyncResponse);}};AsyncRequest.prototype._solveQuicksandChallenge=function(async_response){'use strict';var payload=async_response.getPayload();Bootloader.loadModules(["QuickSandSolver"],function(QuickSandSolver){QuickSandSolver.solveAndSendRequestBack(this,payload);}.bind(this));};AsyncRequest.prototype._displayServerDialog=function(async_response,is_confirmation){'use strict';var payload=async_response.getPayload();if(payload.__dialog!==undefined){this._displayServerLegacyDialog(async_response,is_confirmation);return;}var json=payload.__dialogx;new ServerJS().handle(json);Bootloader.loadModules(["ConfirmationDialog"],function(ConfirmationDialog){ConfirmationDialog.setupConfirmation(async_response,this);}.bind(this));};AsyncRequest.prototype._displayServerLegacyDialog=function(async_response,is_confirmation){'use strict';var model=async_response.getPayload().__dialog;Bootloader.loadModules(["Dialog"],function(Dialog){var dialog=new Dialog(model);if(is_confirmation)dialog.setHandler(this._displayConfirmationHandler.bind(this,dialog));dialog.setCancelHandler(function(){var handler=this.getServerDialogCancelHandler();try{handler&&handler(async_response);}catch(e){throw e;}finally{this.finallyHandler(async_response);}}.bind(this)).setCausalElement(this.relativeTo).show();}.bind(this));};AsyncRequest.prototype._displayConfirmationHandler=function(dialog){'use strict';this.data.confirmed=1;Object.assign(this.data,dialog.getFormData());this.send();};AsyncRequest.prototype.setJSONPTransport=function(transport){'use strict';transport.subscribe('response',this._handleJSONPResponse.bind(this));transport.subscribe('abort',this._handleJSONPAbort.bind(this));this.transport=transport;};AsyncRequest.prototype._handleJSONPResponse=function(_,data){'use strict';this.is_first=this.is_first===undefined;var interpreted=this._interpretResponse(data);interpreted.asyncResponse.is_first=this.is_first;interpreted.asyncResponse.is_last=this.transport.hasFinished();this.invokeResponseHandler(interpreted);if(this.transport.hasFinished())delete this.transport;};AsyncRequest.prototype._handleJSONPAbort=function(){'use strict';this._invokeErrorHandler();delete this.transport;};AsyncRequest.prototype._handleXHRResponse=function(transport){'use strict';var interpreted;if(this.getOption('suppressEvaluation')){interpreted={asyncResponse:new AsyncResponse(this,transport)};}else{var text=transport.responseText,error=null;try{var safe_text=this._unshieldResponseText(text);try{var response=eval('('+safe_text+')');interpreted=this._interpretResponse(response);}catch(exception){error='excep';interpreted={transportError:'eval() failed on async to '+this.getURI()};}}catch(exception){error='empty';interpreted={transportError:exception.message};}if(error){var ErrorSignal=global.ErrorSignal;ErrorSignal&&ErrorSignal.sendErrorSignal('async_xport_resp',[(this._xFbServer?'1008_':'1012_')+error,this._xFbServer||'-',this.getURI(),text.length,text.substr(0,1600)].join(':'));}}this.invokeResponseHandler(interpreted);};AsyncRequest.prototype._unshieldResponseText=function(text){'use strict';var shield="for (;;);",shieldlen=shield.length;if(text.length<=shieldlen)throw new Error('Response too short on async to '+this.getURI());var offset=0;while(text.charAt(offset)==" "||text.charAt(offset)=="\n")offset++;offset&&text.substring(offset,offset+shieldlen)==shield;return text.substring(offset+shieldlen);};AsyncRequest.prototype._interpretResponse=function(response){'use strict';if(response.redirect)return {redirect:response.redirect};var r=new AsyncResponse(this);if(response.__ar!=1){r.payload=response;}else Object.assign(r,response);return {asyncResponse:r};};AsyncRequest.prototype._onStateChange=function(){'use strict';try{if(this.transport.readyState==4){AsyncRequest._inflightCount--;AsyncRequest._inflightPurge();try{if(typeof this.transport.getResponseHeader!=='undefined'&&this.transport.getResponseHeader('X-FB-Debug'))this._xFbServer=this.transport.getResponseHeader('X-FB-Debug');}catch(ignore){}if(this.transport.status>=200&&this.transport.status<300){AsyncRequest.lastSuccessTime=Date.now();this._handleXHRResponse(this.transport);}else if(UserAgent_DEPRECATED.webkit()&&typeof this.transport.status=='undefined'){this._invokeErrorHandler(1002);}else if(AsyncRequestConfig.retryOnNetworkError&&isNetworkError(this.transport)&&this.remainingRetries>0&&!this._requestTimeout){this.remainingRetries--;delete this.transport;this.send(true);return;}else this._invokeErrorHandler();if(this.getOption('asynchronous_DEPRECATED')!==false)delete this.transport;}}catch(exception){if(hasUnloaded())return;delete this.transport;if(this.remainingRetries>0){this.remainingRetries--;this.send(true);}else{!this.getOption('suppressErrorAlerts');var ErrorSignal=global.ErrorSignal;ErrorSignal&&ErrorSignal.sendErrorSignal('async_xport_resp',[1007,this._xFbServer||'-',this.getURI(),exception.message].join(':'));this._invokeErrorHandler(1007);}}};AsyncRequest.prototype._isMultiplexable=function(){'use strict';if(this.getOption('jsonp')||this.getOption('useIframeTransport'))return false;if(!isFacebookURI(this.uri))return false;if(!this.getOption('asynchronous_DEPRECATED'))return false;return true;};AsyncRequest.prototype.handleResponse=function(response){'use strict';var interpreted=this._interpretResponse(response);this.invokeResponseHandler(interpreted);};AsyncRequest.prototype.setMethod=function(m){'use strict';this.method=m.toString().toUpperCase();return this;};AsyncRequest.prototype.getMethod=function(){'use strict';return this.method;};AsyncRequest.prototype.setData=function(obj){'use strict';this.data=obj;return this;};AsyncRequest.prototype.setRequestHeader=function(name,value){'use strict';this.headers[name]=value;return this;};AsyncRequest.prototype.setRawData=function(raw_data){'use strict';this.rawData=raw_data;return this;};AsyncRequest.prototype.getData=function(){'use strict';return this.data;};AsyncRequest.prototype.setContextData=function(key,value,enabled){'use strict';enabled=enabled===undefined?true:enabled;if(enabled)this.context['_log_'+key]=value;return this;};AsyncRequest.prototype._setUserActionID=function(){'use strict';var SessionName=global.SessionName;this.userActionID=(SessionName&&SessionName.getName()||'-')+'/-';};AsyncRequest.prototype.setURI=function(uri){'use strict';var uri_obj=new URI(uri);if(this.getOption('useIframeTransport')&&!isFacebookURI(uri_obj))return this;if(!this._allowCrossOrigin&&!this.getOption('jsonp')&&!this.getOption('useIframeTransport')&&!uri_obj.isSameOrigin())return this;this._setUserActionID();if(!uri||uri_obj.isEmpty()){var ErrorSignal=global.ErrorSignal;if(ErrorSignal){var data={err_code:1013,vip:'-',duration:0,xfb_ip:'-',path:window.location.href,aid:this.userActionID};ErrorSignal.sendErrorSignal('async_error',JSON.stringify(data));ErrorSignal.sendErrorSignal('async_xport_stack',[1013,window.location.href,null,ErrorUtils.normalizeError(new Error()).stack].join(':'));}return this;}this.uri=uri_obj;return this;};AsyncRequest.prototype.getURI=function(){'use strict';return this.uri.toString();};AsyncRequest.prototype.setInitialHandler=function(fn){'use strict';this.initialHandler=fn;return this;};AsyncRequest.prototype.setHandler=function(fn){'use strict';if(validateResponseHandler(fn))this.handler=fn;return this;};AsyncRequest.prototype.getHandler=function(){'use strict';return this.handler||emptyFunction;};AsyncRequest.prototype.setUploadProgressHandler=function(fn){'use strict';if(validateResponseHandler(fn))this.uploadProgressHandler=fn;return this;};AsyncRequest.prototype.setErrorHandler=function(fn){'use strict';if(validateResponseHandler(fn))this.errorHandler=fn;return this;};AsyncRequest.prototype.setTransportErrorHandler=function(fn){'use strict';this.transportErrorHandler=fn;return this;};AsyncRequest.prototype.getErrorHandler=function(){'use strict';return this.errorHandler;};AsyncRequest.prototype.getTransportErrorHandler=function(){'use strict';return this.transportErrorHandler;};AsyncRequest.prototype.setTimeoutHandler=function(timeout,fn){'use strict';if(validateResponseHandler(fn)){this.timeout=timeout;this.timeoutHandler=fn;}return this;};AsyncRequest.prototype.resetTimeout=function(timeout){'use strict';if(!(this.timeoutHandler===null))if(timeout===null){this.timeout=null;clearTimeout(this.timer);this.timer=null;}else{var clear_on_quickling_event=!this._allowCrossPageTransition;this.timeout=timeout;clearTimeout(this.timer);if(clear_on_quickling_event){this.timer=setTimeout(this._handleTimeout.bind(this),this.timeout);}else this.timer=setTimeoutAcrossTransitions(this._handleTimeout.bind(this),this.timeout);}return this;};AsyncRequest.prototype._handleTimeout=function(){'use strict';this._requestTimeout=true;this.abandon();this.timeoutHandler(this);};AsyncRequest.prototype.setNewSerial=function(){'use strict';this.id=++last_id;return this;};AsyncRequest.prototype.setInterceptHandler=function(fn){'use strict';this.interceptHandler=fn;return this;};AsyncRequest.prototype.setFinallyHandler=function(fn){'use strict';this.finallyHandler=fn;return this;};AsyncRequest.prototype.setAbortHandler=function(fn){'use strict';this.abortHandler=fn;return this;};AsyncRequest.prototype.getServerDialogCancelHandler=function(){'use strict';return this.serverDialogCancelHandler;};AsyncRequest.prototype.setServerDialogCancelHandler=function(fn){'use strict';this.serverDialogCancelHandler=fn;return this;};AsyncRequest.prototype.setPreBootloadHandler=function(fn){'use strict';this.preBootloadHandler=fn;return this;};AsyncRequest.prototype.setReadOnly=function(readOnly){'use strict';if(!(typeof readOnly!='boolean'))this.readOnly=readOnly;return this;};AsyncRequest.prototype.setFBMLForm=function(){'use strict';this.writeRequiredParams=["fb_sig"];return this;};AsyncRequest.prototype.getReadOnly=function(){'use strict';return this.readOnly;};AsyncRequest.prototype.setRelativeTo=function(element){'use strict';this.relativeTo=element;return this;};AsyncRequest.prototype.getRelativeTo=function(){'use strict';return this.relativeTo;};AsyncRequest.prototype.setStatusClass=function(c){'use strict';this.statusClass=c;return this;};AsyncRequest.prototype.setStatusElement=function(element){'use strict';this.statusElement=element;return this;};AsyncRequest.prototype.getStatusElement=function(){'use strict';return ge(this.statusElement);};AsyncRequest.prototype._isRelevant=function(){'use strict';if(this._allowCrossPageTransition)return true;if(!this.id)return true;return this.id>id_threshold;};AsyncRequest.prototype.clearStatusIndicator=function(){'use strict';var statusElem=this.getStatusElement();if(statusElem){CSS.removeClass(statusElem,'async_saving');CSS.removeClass(statusElem,this.statusClass);}};AsyncRequest.prototype.addStatusIndicator=function(){'use strict';var statusElem=this.getStatusElement();if(statusElem){CSS.addClass(statusElem,'async_saving');CSS.addClass(statusElem,this.statusClass);}};AsyncRequest.prototype.specifiesWriteRequiredParams=function(){'use strict';return this.writeRequiredParams.every(function(param){this.data[param]=this.data[param]||Env[param]||(ge(param)||{}).value;if(this.data[param]!==undefined)return true;return false;},this);};AsyncRequest.prototype.setOption=function(opt,v){'use strict';if(typeof this.option[opt]!='undefined')this.option[opt]=v;return this;};AsyncRequest.prototype.getOption=function(opt){'use strict';typeof this.option[opt]=='undefined';return this.option[opt];};AsyncRequest.prototype.abort=function(){'use strict';if(this.transport){var old_handler=this.getTransportErrorHandler();this.setOption('suppressErrorAlerts',true);this.setTransportErrorHandler(emptyFunction);this._requestAborted=true;this.transport.abort();this.setTransportErrorHandler(old_handler);}this.abortHandler();AsyncMultiplex.unschedule(this);};AsyncRequest.prototype.abandon=function(){'use strict';clearTimeout(this.timer);this.setOption('suppressErrorAlerts',true).setHandler(emptyFunction).setErrorHandler(emptyFunction).setTransportErrorHandler(emptyFunction);if(this.transport){this._requestAborted=true;this.transport.abort();}this.abortHandler();AsyncMultiplex.unschedule(this);};AsyncRequest.prototype.setNectarData=function(nctrParams){'use strict';if(nctrParams){if(this.data.nctr===undefined)this.data.nctr={};Object.assign(this.data.nctr,nctrParams);}return this;};AsyncRequest.prototype.setNectarModuleDataSafe=function(elem){'use strict';if(this.setNectarModuleData)this.setNectarModuleData(elem);return this;};AsyncRequest.prototype.setNectarImpressionIdSafe=function(){'use strict';if(this.setNectarImpressionId)this.setNectarImpressionId();return this;};AsyncRequest.prototype.setAllowCrossPageTransition=function(allow){'use strict';this._allowCrossPageTransition=!!allow;if(this.timer)this.resetTimeout(this.timeout);return this;};AsyncRequest.prototype.setAllowIrrelevantRequests=function(allowIrrelevantRequests){'use strict';this._allowIrrelevantRequests=allowIrrelevantRequests;return this;};AsyncRequest.prototype.setAllowCrossOrigin=function(allow){'use strict';this._allowCrossOrigin=allow;return this;};AsyncRequest.prototype.setAllowCredentials=function(allow){'use strict';this._allowCredentials=allow;return this;};AsyncRequest.prototype.setIsBackgroundRequest=function(isBackgroundRequest){'use strict';this._isBackgroundRequest=isBackgroundRequest;return this;};AsyncRequest.prototype.send=function(isRetry){'use strict';isRetry=isRetry||false;if(!this.uri)return false;!this.errorHandler&&!this.getOption('suppressErrorHandlerWarning');if(this.getOption('jsonp')&&this.method!='GET')this.setMethod('GET');if(this.getOption('useIframeTransport')&&this.method!='GET')this.setMethod('GET');this.timeoutHandler!==null&&(this.getOption('jsonp')||this.getOption('useIframeTransport'));if(!this.getReadOnly()){this.specifiesWriteRequiredParams();if(this.method!='POST')return false;}Object.assign(this.data,getAsyncParams(this.method));if(!isEmpty(this.context)){Object.assign(this.data,this.context);this.data.ajax_log=1;}if(Env.force_param)Object.assign(this.data,Env.force_param);this._setUserActionID();if(this.getOption('bundle')&&this._isMultiplexable()){AsyncMultiplex.schedule(this);return true;}this.setNewSerial();if(!this.getOption('asynchronous_DEPRECATED'))this.uri.addQueryData({__s:1});if(AsyncRequestConfig.pkgCohort){var _uri$addQueryData;this.uri.addQueryData((_uri$addQueryData={},_uri$addQueryData[AsyncRequestConfig.PKG_COHORT_KEY]=AsyncRequestConfig.pkgCohort,_uri$addQueryData));}Arbiter.inform('AsyncRequest/send',{request:this});var uri_str,query;if(this.method=='GET'||this.rawData){uri_str=this.uri.addQueryData(this.data).toString();query=this.rawData||'';}else{if(this._allowCrossOrigin)this.uri.addQueryData({__a:1});uri_str=this.uri.toString();query=PHPQuerySerializer.serialize(this.data);}if(this.transport)return false;if(this.getOption('jsonp')||this.getOption('useIframeTransport')){requireLazy(['JSONPTransport'],function(JSONPTransport){var transport=new JSONPTransport(this.getOption('jsonp')?'jsonp':'iframe',this.uri);this.setJSONPTransport(transport);transport.send();}.bind(this));return true;}var transport=getSameOriginTransport();if(!transport)return false;transport.onreadystatechange=TimeSlice.guard(this._onStateChange.bind(this),'XHR.onreadystatechange');if(this.uploadProgressHandler&&supportsUploadProgress(transport))transport.upload.onprogress=this.uploadProgressHandler.bind(this);if(!isRetry)this.remainingRetries=this.getOption('retries');if(global.ErrorSignal)this._sendTimeStamp=this._sendTimeStamp||Date.now();this.transport=transport;try{this.transport.open(this.method,uri_str,this.getOption('asynchronous_DEPRECATED'));}catch(exception){return false;}if(!this.uri.isSameOrigin()&&!this.getOption('jsonp')&&!this.getOption('useIframeTransport')){if(!supportsCrossOrigin(this.transport))return false;if((isFacebookURI(this.uri)||isMessengerDotComURI(this.uri))&&this._allowCredentials!==false)this.transport.withCredentials=true;}if(this.method=='POST'&&!this.rawData)this.transport.setRequestHeader('Content-Type','application/x-www-form-urlencoded');if(this._isBackgroundRequest)this.transport.setRequestHeader('X_FB_BACKGROUND_STATE','1');var asyncHeaders=getAsyncHeaders(this.uri);Object.keys(asyncHeaders).forEach(function(name){this.transport.setRequestHeader(name,asyncHeaders[name]);}.bind(this));Arbiter.inform('AsyncRequest/will_send',{request:this});for(var headerName in this.headers)if(this.headers.hasOwnProperty(headerName))this.transport.setRequestHeader(headerName,this.headers[headerName]);this.addStatusIndicator();this.transport.send(query);if(this.timeout!==null)this.resetTimeout(this.timeout);AsyncRequest._inflightCount++;AsyncRequest._inflightAdd(this);return true;};AsyncRequest._inflightAdd=function(ar){'use strict';this._inflight.push(ar);};AsyncRequest._inflightPurge=function(){'use strict';AsyncRequest._inflight=AsyncRequest._inflight.filter(function(ar){return ar.transport&&ar.transport.readyState<4;});};AsyncRequest.bootstrap=function(href,elem,is_post){'use strict';var method='GET',readonly=true,data={};if(is_post||elem&&elem.rel=='async-post'){method='POST';readonly=false;if(href){href=new URI(href);data=href.getQueryData();href.setQueryData({});}}var status_elem=Parent.byClass(elem,'stat_elem')||elem;if(status_elem&&CSS.hasClass(status_elem,'async_saving'))return false;var async=new AsyncRequest(href).setReadOnly(readonly).setMethod(method).setData(data).setNectarModuleDataSafe(elem).setRelativeTo(elem);if(elem){async.setHandler(function(response){Event.fire(elem,'success',{response:response});});async.setErrorHandler(function(response){if(Event.fire(elem,'error',{response:response})!==false)AsyncResponse.defaultErrorHandler(response);});}if(status_elem){async.setStatusElement(status_elem);var status_class=status_elem.getAttribute('data-status-class');status_class&&async.setStatusClass(status_class);}async.send();return false;};AsyncRequest.post=function(href,data){'use strict';new AsyncRequest(href).setReadOnly(false).setMethod('POST').setData(data).send();return false;};AsyncRequest.getLastID=function(){'use strict';return last_id;};AsyncRequest.getInflightCount=function(){'use strict';return this._inflightCount;};AsyncRequest._inflightEnable=function(){'use strict';if(UserAgent_DEPRECATED.ie())Run.onUnload(function(){AsyncRequest._inflight.forEach(function(ar){if(ar.transport&&ar.transport.readyState<4){ar.transport.abort();delete ar.transport;}});});};Object.assign(AsyncRequest,{suppressOnloadToken:{},_inflight:[],_inflightCount:0,_inflightAdd:emptyFunction,_inflightPurge:emptyFunction});var _asyncMultiplex,_pendingAsyncMultiplexes=[];function AsyncMultiplex(){'use strict';this._requests=[];}AsyncMultiplex.prototype.add=function(request){'use strict';this._requests.push(request);};AsyncMultiplex.prototype.remove=function(request){'use strict';var requests=this._requests,requestsSent=this._requestsSent;for(var ii=0,jj=requests.length;ii<jj;ii++)if(requests[ii]===request)if(requestsSent){requests[ii]=null;}else requests.splice(ii,1);};AsyncMultiplex.prototype.send=function(){'use strict';!!this._requestsSent?invariant(0):undefined;this._requestsSent=true;this._wrapperRequest=null;var requests=this._requests;if(!requests.length)return;var request;if(requests.length===1){request=requests[0];}else{var data=requests.map(function(request){return [request.uri.getPath(),PHPQuerySerializer.serialize(request.data)];});request=this._wrapperRequest=new AsyncRequest('/ajax/proxy.php').setAllowCrossPageTransition(true).setData({data:data}).setHandler(this._handler.bind(this)).setTransportErrorHandler(this._transportErrorHandler.bind(this));}request.setOption('bundle',false).send();};AsyncMultiplex.prototype._handler=function(response){'use strict';var responses=response.getPayload().responses;if(responses.length!==this._requests.length)return;for(var ii=0;ii<this._requests.length;ii++){var request=this._requests[ii];if(request===null)continue;var request_path=request.uri.getPath();if(this._wrapperRequest)request.id=this._wrapperRequest.id;if(responses[ii][0]!==request_path){request.invokeResponseHandler({transportError:'Wrong response order in bundled request to '+request_path});continue;}request.handleResponse(responses[ii][1]);}_pendingAsyncMultiplexes.splice(_pendingAsyncMultiplexes.indexOf(this,1));};AsyncMultiplex.prototype._transportErrorHandler=function(response){'use strict';var interpreted={transportError:response.errorDescription},paths=this._requests.map(function(request){if(this._wrapperRequest)request.id=this._wrapperRequest.id;request.invokeResponseHandler(interpreted);return request.uri.getPath();},this);};AsyncMultiplex.schedule=function(request){'use strict';if(!_asyncMultiplex){_asyncMultiplex=new AsyncMultiplex();_pendingAsyncMultiplexes.push(_asyncMultiplex);setTimeout(function(){_asyncMultiplex.send();_asyncMultiplex=null;},0);}_asyncMultiplex.add(request);return _asyncMultiplex;};AsyncMultiplex.unschedule=function(request){'use strict';_pendingAsyncMultiplexes.forEach(function(asyncMultiplex){asyncMultiplex.remove(request);});};global.AsyncRequest=AsyncRequest;module.exports=AsyncRequest;},null);